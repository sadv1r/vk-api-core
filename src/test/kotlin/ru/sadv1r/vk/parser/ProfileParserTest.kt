package ru.sadv1r.vk.parser

//import org.junit.runner.RunWith
//import org.mockito.Mockito
//import org.powermock.api.mockito.PowerMockito
//import org.powermock.core.classloader.annotations.PrepareForTest
//import org.powermock.modules.junit4.PowerMockRunner
import com.fasterxml.jackson.databind.JsonNode
import com.fasterxml.jackson.module.kotlin.jacksonObjectMapper
import org.junit.After
import org.junit.Assert.*
import org.junit.Assume.*
import org.junit.Before
import org.junit.Test
import ru.sadv1r.vk.parser.model.Profile
import java.util.*
import kotlin.reflect.functions
import kotlin.reflect.jvm.isAccessible

/**
 * Created on 4/4/16.
 *
 * @author sadv1r
 *
 * @version 0.1
 */
class ProfileParserTest {
    lateinit var profileParser: ProfileParser

    @Before
    fun setUp() {
        profileParser = ProfileParser()
    }

    @After
    fun tearDown() {

    }

    @Test
    fun getProfile() {
        val node: JsonNode = jacksonObjectMapper().readTree("{\"response\":[" +
                "{\"id\":1,\"first_name\":\"Павел\",\"last_name\":\"Дуров\"}" +
                "]}")
        val expected = Profile(1, "Павел", "Дуров")

        val methodGetProfile = ProfileParser::class.functions.single() {
            it.name.equals("getProfile") && it.parameters[1].name.equals("jsonNode")
        }

        val methodGetProfileIsAccessible = methodGetProfile.isAccessible

        methodGetProfile.isAccessible = true
        val getProfileResult = methodGetProfile.call(profileParser, node) as Profile
        methodGetProfile.isAccessible = methodGetProfileIsAccessible

        assertEquals(expected.id, getProfileResult.id)
        assertEquals(expected.firstName, getProfileResult.firstName)
        assertEquals(expected.lastName, getProfileResult.lastName)
    }

    @Test
    fun getProfile1() {
        val node: JsonNode = jacksonObjectMapper().readTree("{\"response\":[" +
                "{\"id\":1,\"first_name\":\"Павел\",\"last_name\":\"Дуров\",\"sex\":2,\"bdate\":\"10.10.1984\",\"city\":{\"id\":2,\"title\":\"Санкт-Петербург\"},\"country\":{\"id\":1,\"title\":\"Россия\"},\"photo_50\":\"http://cs629231.vk.me/v629231001/c543/FfB--bOEVOY.jpg\",\"photo_id\":\"1_376599151\",\"has_photo\":1,\"verified\":1,\"home_town\":\"\"}" +
                "]}")

        val expected = Profile(1, "Павел", "Дуров", sex = 2, bdate = "10.10.1984", city = Profile.City(2, "Санкт-Петербург"), country = Profile.Country(1, "Россия"), photo50 = "http://cs629231.vk.me/v629231001/c543/FfB--bOEVOY.jpg", photoId = "1_376599151", hasPhoto = true, verified = true, homeTown = "")

        val methodGetProfile = ProfileParser::class.functions.single() {
            it.name.equals("getProfile") && it.parameters[1].name.equals("jsonNode")
        }

        val methodGetProfileIsAccessible = methodGetProfile.isAccessible

        methodGetProfile.isAccessible = true
        val getProfileResult = methodGetProfile.call(profileParser, node) as Profile
        methodGetProfile.isAccessible = methodGetProfileIsAccessible

        assertEquals(expected.id, getProfileResult.id)
        assertEquals(expected.firstName, getProfileResult.firstName)
        assertEquals(expected.sex, getProfileResult.sex)
        assertEquals(expected.bdate, getProfileResult.bdate)
        assertEquals(expected.city, getProfileResult.city)
        assertEquals(expected.country, getProfileResult.country)
        assertEquals(expected.photo50, getProfileResult.photo50)
        assertEquals(expected.photoId, getProfileResult.photoId)
        assertEquals(expected.hasPhoto, getProfileResult.hasPhoto)
        assertEquals(expected.verified, getProfileResult.verified)
        assertEquals(expected.homeTown, getProfileResult.homeTown)
        assertEquals(expected.city!!.id, getProfileResult.city!!.id)
        assertEquals(expected.city!!.title, getProfileResult.city!!.title)
        assertEquals(expected.country!!.id, getProfileResult.country!!.id)
        assertEquals(expected.country!!.title, getProfileResult.country!!.title)
    }

    @Test
    fun getProfile2() {
        val node: JsonNode = jacksonObjectMapper().readTree("{\"response\":[" +
                "{\"id\":1,\"first_name\":\"Павел\",\"last_name\":\"Дуров\",\"sex\":2,\"bdate\":\"10.10.1984\",\"city\":{\"id\":2,\"title\":\"Санкт-Петербург\"},\"country\":{\"id\":1,\"title\":\"Россия\"},\"photo_50\":\"http://cs629231.vk.me/v629231001/c543/FfB--bOEVOY.jpg\",\"photo_id\":\"1_376599151\",\"has_photo\":1,\"verified\":1,\"home_town\":\"\"}," +
                "{\"id\":2,\"first_name\":\"Александра\",\"last_name\":\"Владимирова\",\"sex\":1,\"photo_50\":\"http://cs626124.vk.me/v626124002/6705/aNUnOD3r3BU.jpg\",\"photo_id\":\"2_413083015\",\"has_photo\":1,\"verified\":0,\"hidden\":1}" +
                "]}")

        val expected = ArrayList<Profile>()
        expected.add(Profile(1, "Павел", "Дуров", sex = 2, bdate = "10.10.1984", city = Profile.City(2, "Санкт-Петербург"), country = Profile.Country(1, "Россия"), photo50 = "http://cs629231.vk.me/v629231001/c543/FfB--bOEVOY.jpg", photoId = "1_376599151", hasPhoto = true, verified = true, homeTown = ""))
        expected.add(Profile(2, "Александра", "Владимирова", sex = 1, photo50 = "http://cs626124.vk.me/v626124002/6705/aNUnOD3r3BU.jpg", photoId = "2_413083015", hasPhoto = true, verified = false, hidden = true))

        val methodGetProfile = ProfileParser::class.functions.single() {
            it.name.equals("getProfiles") && it.parameters[1].name.equals("jsonNode")
        }

        val methodGetProfileIsAccessible = methodGetProfile.isAccessible

        methodGetProfile.isAccessible = true
        @Suppress("UNCHECKED_CAST")
        val getProfileResult = methodGetProfile.call(profileParser, node) as List<Profile>
        methodGetProfile.isAccessible = methodGetProfileIsAccessible

        for ((index, value) in expected.withIndex()) {
            assertEquals(value.id, getProfileResult[index].id)
            assertEquals(value.firstName, getProfileResult[index].firstName)
            assertEquals(value.sex, getProfileResult[index].sex)
            assertEquals(value.bdate, getProfileResult[index].bdate)
            assertEquals(value.city, getProfileResult[index].city)
            assertEquals(value.country, getProfileResult[index].country)
            assertEquals(value.photo50, getProfileResult[index].photo50)
            assertEquals(value.photoId, getProfileResult[index].photoId)
            assertEquals(value.hasPhoto, getProfileResult[index].hasPhoto)
            assertEquals(value.verified, getProfileResult[index].verified)
            assertEquals(value.homeTown, getProfileResult[index].homeTown)
        }
        assertEquals(expected[0].city!!.id, getProfileResult[0].city!!.id)
        assertEquals(expected[0].city!!.title, getProfileResult[0].city!!.title)
        assertEquals(expected[0].country!!.id, getProfileResult[0].country!!.id)
        assertEquals(expected[0].country!!.title, getProfileResult[0].country!!.title)
        assertNull(getProfileResult[1].city)
        assertNull(getProfileResult[1].country)
    }

    @Test
    fun getProfile3() {
        val node: JsonNode = jacksonObjectMapper().readTree("{\"response\":[" +
                "{\"id\":3,\"first_name\":\"DELETED\",\"last_name\":\"\",\"deactivated\":\"deleted\"}" +
                "]}")
        val expected = Profile(3, "DELETED", "", deactivated = Profile.Deactivated.DELETED)

        val methodGetProfile = ProfileParser::class.functions.single() {
            it.name.equals("getProfile") && it.parameters[1].name.equals("jsonNode")
        }

        val methodGetProfileIsAccessible = methodGetProfile.isAccessible

        methodGetProfile.isAccessible = true
        val getProfileResult = methodGetProfile.call(profileParser, node) as Profile
        methodGetProfile.isAccessible = methodGetProfileIsAccessible

        assertEquals(expected.id, getProfileResult.id)
        assertEquals(expected.firstName, getProfileResult.firstName)
        assertEquals(expected.lastName, getProfileResult.lastName)
        assertEquals(expected.deactivated, getProfileResult.deactivated)
    }

    @Test
    fun getProfile4() {
        val vkIds = listOf(4451,11012,14487,20642,22408,25498,32324,35605,55894,72618,83868,83922,86662,90107,106660,108896,139337,142487,143695,165723,176786,179802,180800,183711,186136,194112,194961,201541,217229,218622,232645,248454,253980,256823,275295,278570,304966,341599,342801,351391,351558,355069,359877,367115,384423,393967,398488,398633,405202,417500,421695,453749,463477,474788,499423,520616,534256,539336,543500,550877,573312,583988,584060,586828,593904,604279,615224,630020,633929,670601,674543,687237,690245,718103,719666,753706,757844,760263,765761,773070,773340,808571,829006,844695,855827,857439,867790,870137,877256,883208,901277,922459,932013,939383,952082,960491,969030,973789,996116,999411,1004480,1005720,1009221,1013617,1030178,1066051,1076584,1080178,1117363,1118628,1118879,1139027,1143370,1144684,1182344,1190711,1204705,1207009,1210016,1211565,1217153,1219296,1221219,1232309,1253989,1261072,1261230,1277529,1297505,1311302,1323138,1338704,1344200,1345212,1352877,1360630,1365944,1374732,1386570,1394146,1406920,1419501,1425444,1466354,1471344,1482955,1490860,1497259,1497323,1504094,1528621,1530741,1551424,1555694,1569340,1585370,1591482,1593674,1609644,1614456,1645800,1656166,1659842,1683019,1689361,1690334,1700961,1732249,1735475,1753629,1755438,1787150,1787618,1792628,1797965,1802436,1819704,1824661,1834625,1844937,1850608,1860445,1870328,1870591,1873878,1874495,1896915,1898844,1948924,1967961,1992516,1993245,1993956,2019173,2030882,2044872,2069945,2088613,2120747,2120775,2122581,2127999,2135584,2142114,2147802,2153396,2168766,2196541,2226518,2248810,2248974,2260681,2265383,2269505,2281560,2287623,2288979,2295911,2304593,2312954,2320282,2321866,2325179,2330480,2335826,2345223,2345440,2380690,2405689,2411187,2417809,2423721,2424539,2434482,2439126,2441983,2463410,2463736,2478857,2479985,2503832,2522142,2527530,2534703,2535179,2555392,2555800,2556409,2568977,2577333,2580363,2587254,2617006,2620136,2637393,2664151,2675910,2679109,2679285,2681072,2684720,2689059,2697538,2700514,2739757,2782211,2804935,2811261,2813390,2816489,2827716,2856350,2875090,2875391,2882489,2912003,2920493,2920654,2940582,2961412,2979910,2987978,2988515,2991684,2995422,3023716,3027859,3028921,3034215,3045850,3049178,3054866,3073153,3084889,3099259,3107718,3121897,3129156,3153676,3163069,3170389,3189280,3196195,3198187,3216628,3217182,3222304,3227597,3228545,3231147,3266969,3273521,3278630,3295299,3296178,3296218,3317614,3318909,3326678,3334761,3357644,3361151,3367904,3369641,3374004,3385374,3389477,3399993,3400083,3411288,3442521,3468951,3469628,3483584,3494847,3497799,3498532,3510637,3527291,3532127,3564871,3589802,3598589,3606487,3609288,3616708,3623116,3647780,3665813,3668457,3678747,3690759,3715953,3727794,3728056,3734029,3757928,3773135,3784273,3796200,3797033,3807216,3818792,3820799,3824022,3830080,3834023,3842921,3844591,3891904,3896538,3897524,3900080,3904101,3933775,3960412,3972430,3976989,3978940,3988624,3993706,4014106,4015087,4021312,4054337,4056941,4073335,4079682,4087670,4101613,4105843,4106345,4110085,4112469,4117228,4125529,4130013,4130230,4135236,4139179,4147060,4148003,4157524,4169399,4176217,4176727,4189417,4216135,4249780,4251193,4275783,4275813,4294930,4339659,4360161,4365627,4376754,4383610,4384022,4410479,4413840,4416812,4425845,4431305,4456455,4470256,4484005,4486873,4488581,4507784,4517481,4531662,4549783,4552035,4596629,4598626,4606897,4621929,4637812,4640297,4640600,4642623,4646058,4654755,4658185,4660065,4661588,4672096,4685987,4716727,4747098,4750929,4751571,4766883,4782923,4807323,4810890,4820752,4838434,4847392,4863089,4864744,4871860,4878307,4925353,4951130,4952066,5051566,5063217,5072162,5073118,5082432,5088829,5088927,5090691,5092257,5104232,5106947,5139588,5147438,5148898,5149422,5170586,5222826,5235720,5288960,5319657,5327376,5342664,5347635,5362778,5370152,5383985,5384030,5395223,5399846,5401880,5402975,5410997,5416638,5426096,5427286,5464692,5484752,5486802,5502072,5520691,5520939,5528840,5532181,5545542,5559842,5561146,5563144,5583703,5595607,5603024,5635679,5637574,5647211,5663965,5671061,5722826,5762175,5802859,5806070,5811052,5825762,5828810,5839252,5840816,5849139,5850693,5890467,5916193,5959617,5962909,5974974,6014449,6014828,6019453,6028537,6029110,6037006,6037720,6068162,6090409,6093223,6095753,6108798,6109810,6126320,6129600,6150064,6181702,6215701,6221646,6233397,6254632,6262938,6281345,6298929,6308962,6310991,6325506,6330141,6338082,6368641,6370630,6372257,6374147,6388070,6394351,6407610,6414225,6438464,6497478,6504723,6519015,6545887,6552084,6553292,6651086,6660950,6692280,6710957,6728002,6760446,6766022,6766171,6821487,6839850,6877598,6902050,6911400,6919293,6922275,6937016,6944329,6949544,7003444,7022348,7028194,7055438,7065927,7086208,7120826,7136018,7138048,7140535,7156533,7172640,7178586,7211348,7244514,7250789,7257697,7271669,7289402,7339724,7349423,7354696,7400842,7404124,7417735,7423798,7429866,7436232,7446053,7451064,7467544,7472099,7472881,7474814,7478309,7481941,7509863,7569778,7590229,7620781,7639266,7648609,7650765,7655136,7667563,7678770,7695921,7710853,7733575,7735835,7765050,7788240,7816370,7824030,7826039,7826242,7830840,7850149,7873436,7901655,7921667,7932232,7949098,7957575,7981475,7982713,8029532,8091689,8099715,8117346,8136111,8158436,8183599,8189373,8190717,8195962,8200701,8200759,8212282,8229377,8236485,8250752,8259156,8283211,8293218,8306954,8315063,8329874,8335534,8390794,8391942,8394119,8419645,8428953,8437281,8441811,8441932,8443441,8459394,8461647,8473406,8486643,8501385,8505132,8552129,8573100,8577222,8615956,8626874,8631028,8698503,8703998,8707317,8722568,8730166,8735579,8738320,8746308,8748772,8752683,8762763,8779518,8806111,8809666,8816857,8832111,8833076,8837124,8881090,8904737,8914892,8920141,8921210,8934217,8952974,8953820,9009555,9029292,9040500,9061148,9064632,9117217,9144878,9171772,9176328,9204159,9211282,9213938,9289575,9306903,9313032,9323153,9338056,9369267,9375096,9380047,9410335,9439414,9458090,9481374,9553927,9560814,9582056,9599840,9601063,9606720,9673312,9674852,9730718,9732135,9738811,9759574,9761714,9773294,9780325,9782717,9787158,9804917,9832625,9842703,9871256,9872050,9893645,9908317,9914973,9918378,9927107,9931539,9957834,10007855,10007901,10017624,10018208,10027142,10069278,10086504,10103109,10157767,10194235,10213636,10223199,10238122,10248183,10254137,10278330,10286134,10289754,10312397,10322809,10332803,10334401,10363049,10390519,10396290,10403470,10468392,10480073,10504514,10507906,10575826,10596719,10603038,10615735,10663820,10693328,10698129,10702195,10744279,10806932,10811716,10874924,10882366,10887531,10918882,11034261,11065095,11078396,11095040,11120160,11141762,11166484,11167821,11196431,11208102,11210234,11217306,11228065,11230278,11234513,11264304,11272808,11298033,11302371,11302738,11309782,11315470,11338096,11345308,11352776,11380136,11408375,11425354,11428387,11428874,11452362,11488114,11495762,11506958,11512296,11524758,11529005,11530492,11530813,11546609,11547869,11572920,11617708,11618253,11619944,11632503,11633063,11641624,11670593,11706041,11714360,11719873,11728707,11804118,11823271,11833249,11850561,11879095,11895880,11939337,11945067,11959091,11998156,12023413,12078379,12092224,12159980,12167806,12186167,12188890,12218971,12231793,12278873,12331860,12332528,12357864,12414359,12415598,12431597,12441295,12449407,12492863,12528130,12555103,12576134,12590586,12599318,12613426,12629845,12660160,12725319,12743671,12772032,12788337,12813580,12820222,12880303,12910028,13002599,13013124,13037445,13050502,13062627,13063963,13111499,13136804,13141720,13259656,13353079,13358689,13363049,13383212,13432584,13440882,13441516,13451864,13496339,13527595,13541243,13555969,13662622,13678060,13678102,13683910,13698924,13730355,13749423,13751396,13771290,13791415,13791485,13792968,13815759,13839573,13957337,13958643,13976497,14032217,14074241,14085012,14107592,14125408,14128444,14130957,14169577,14170672,14182565,14191919,14202290,14203531,14206216,14206582,14224876,14234674,14246504,14261217,14271280,14279801,14287484,14289868,14318727,14336124,14368578,14389739,14419054,14434204,14449009,14460957,14462843,14500261,14525705,14563126,14566098,14583837,14584324,14586174,14614778,14642724,14716596,14763794,14774970,14799518,14848704,14849805,14862832,14935728,14939583,14954808,14957227,14961794,15010224,15045935,15084913,15127088,15133670,15137997,15143481,15145561,15153846,15200821,15205081,15302763,15303394,15338939,15379550,15413729,15433972,15441299,15451994,15466745,15529377,15535833,15574894,15592575,15603672,15627435,15645146,15646415,15647890,15651099,15676618,15698010,15700063,15700145,15729729,15764160,15808789,15857516,15858326,15898108,15904595,15905318,15918702,15929438,15951404,15954267,15969664,15997527,16017998,16031224,16036878,16042625,16082555,16088767,16113275,16150312,16159813,16160592,16174819,16262396,16294293,16315033,16316785,16322535,16322884,16355581,16428414,16432405,16455007,16478153,16478441,16544512,16546859,16554025,16558158,16633763,16654904,16662504,16689571,16742090,16744540,16812832,16816968,16848187,16852157,16877844,16880520,17051222,17113257,17128287,17142730,17151654,17176075,17199756,17229776,17234778,17272176,17274903,17283267,17294712,17300542,17342603,17357817,17373285,17375971,17402715,17418836,17423482,17434461,17482160,17483610,17501587,17508679,17542475,17651320,17699958,17704072,17710679,17746442,17758535,17762547,17765765,17766406,17776363,17824396,17825549,17826525,17836886,17879996,17890562,17919489,17948382,17950894,17970528,18010333,18027949,18037356,18044266,18080975,18093941,18114501,18127974,18130232,18139156,18145909,18150460,18153382,18171071,18182371,18274695,18305696,18312308,18325240,18326066,18329708,18354755,18385074,18405241,18414075,18430708,18454707,18470692,18553194,18659803,18671587,18678850,18679686,18699369,18712839,18713794,18748364,18768368,18773951,18774274,18780310,18781680,18834789,18876273,18883522,18904942,18909479,18940615,19004670,19010463,19024686,19036273,19075734,19078864,19104233,19156891,19166548,19188565,19217848,19223841,19237222,19266598,19277774,19281076,19296946,19300990,19305609,19309483,19317962,19330982,19332751,19339123,19360492,19371475,19402549,19403308,19432367,19433727,19444608,19466479,19518701,19611360,19692880,19697691,19755505,19774210,19792610,19809907,19815332,19821596,19822362,19905070,19909716,20034037,20066762,20069972,20091147,20098023,20112155,20116944,20164150,20166556,20168330,20173171,20207832,20215266,20221512,20236839,20259518,20274530,20306126,20332670,20375132,20399181,20433836,20445905,20446128,20454496,20468273,20471174,20484140,20506020,20506477,20528255,20528989,20565861,20568334,20586366,20592240,20592444,20617381,20617475,20626469,20654511,20659329,20663338,20691037,20708560,20784308,20786911,20810274,20849805,20854342,20861966,20867263,20903315,20904485,20915397,20940851,20945743,21003321,21024938,21043955,21069619,21082970,21129509,21182619,21217421,21231589,21235942,21253463,21264536,21312382,21315158,21392305,21393825,21394374,21454294,21460417,21471756,21548036,21594285,21599581,21642485,21716843,21764064,21783282,21816765,21830375,21855554,21864661,21929383,22005092,22063639,22085520,22128412,22148931,22244869,22250291,22280389,22402367,22421991,22436623,22446352,22461596,22485554,22510430,22541887,22543298,22571520,22579559,22628809,22653856,22658411,22660324,22679615,22681435,22690088,22698740,22704914,22718979,22733989,22734288,22763343,22766248,22808179,22813226,22821549,22844011,22852589,22886200,22889341,22897287,22951513,23027915,23032874,23040847,23070285,23145363,23159485,23167223,23193467,23205945,23221883,23238954,23292835,23307966,23309328,23328036,23392240,23402690,23404758,23437605,23440396,23466495,23484702,23504026,23539069,23583460,23697088,23702090,23709619,23739051,23781795,23787537,23852173,23883948,23888335,23922074,23931010,24016623,24017420,24059441,24071477,24072155,24081506,24087693,24149753,24168471,24174986,24175846,24199013,24221611,24243103,24254159,24255695,24321442,24366532,24370394,24379837,24495638,24496049,24572941,24582675,24593565,24628596,24661869,24673641,24675391,24701844,24724401,24734708,24796891,24850333,24929449,24966125,25072101,25120029,25146411,25260511,25264142,25267582,25270141,25318578,25342235,25350777,25373281,25387860,25404974,25415614,25445668,25452098,25466484,25472838,25521028,25576528,25601265,25605243,25606571,25646299,25652329,25654084,25693757,25698649,25701012,25782685,25837808,25860914,25873542,25884931,25967311,26082478,26098474,26117564,26143548,26154539,26166821,26190480,26240236,26243477,26266380,26270845,26285273,26366105,26427838,26445118,26456296,26461024,26487858,26524848,26544543,26565846,26700000,26761425,26871440,26872374,26873913,26880363,26906492,26909170,26961770,27002768,27013345,27043662,27190495,27207848,27258317,27259721,27264985,27274799,27277214,27323177,27334439,27370935,27372723,27377140,27378077,27417769,27480155,27508513,27511741,27517165,27540087,27574482,27584127,27589485,27638570,27693774,27707088,27722846,27733929,27853292,28067432,28103082,28140555,28176358,28194555,28209318,28231752,28312283,28326920,28333924,28486833,28533793,28632151,28657267,28697970,28710403,28739872,28852771,28877841,28887597,28929034,28933450,29028876,29038148,29053567,29054843,29061991,29104697,29125589,29197071,29234639,29256646,29316162,29317748,29348738,29354899,29362554,29366784,29524874,29543514,29574735,29662356,29801279,29821213,29823023,29903130,29950520,30006001,30024409,30076693,30096540,30117267,30119508,30186700,30202041,30274772,30310600,30375825,30414758,30416431,30428273,30451966,30483060,30493143,30520286,30606451,30706131,30720363,30725550,30728630,30906606,31016405,31059808,31061544,31145080,31243318,31251440,31259212,31363841,31367821,31372098,31517418,31544322,31552873,31570206,31661094,31664402,31672030,31674516,31687874,31707826,31768124,31823581,31826429,31846310,31908510,31914357,31935312,31963430,32044407,32095788,32125669,32130752,32149219,32157954,32166386,32181080,32245464,32247941,32249651,32281139,32322216,32456651,32538219,32576445,32594811,32614222,32636483,32663693,32765351,32800278,32860707,32878913,32910174,32920651,32940658,32997135,33007532,33008548,33067877,33137636,33197015,33221917,33329565,33365891,33383165,33391542,33453272,33460717,33470374,33475735,33501981,33516585,33516657,33572912,33573077,33575244,33595809,33727751,33773067,33833197,33938156,33965171,33969805,34034922,34066268,34069745,34133731,34156095,34210939,34356988,34411413,34415242,34441211,34486166,34578696,34627624,34636155,34674913,34834698,34849779,34940419,34942884,35022550,35144578,35145883,35248446,35309037,35371655,35604801,35698292,35703642,35776203,35908161,35916097,35945890,36061760,36066036,36205545,36284530,36329569,36344509,36391973,36438364,36444747,36461813,36533358,36656759,36744024,36806935,36840660,36841665,36871613,36932515,37011987,37080266,37096025,37135847,37225669,37269095,37302374,37385059,37398159,37453073,37482960,37643916,37663945,37695610,37766696,37842607,37887205,38010722,38149031,38204270,38210250,38218997,38240114,38256015,38326500,38379137,38381512,38491647,38548314,38600319,38609445,38612300,38660742,38717867,38810653,38823249,38832227,38849197,38896662,38959835,39016282,39054401,39075718,39098188,39121923,39198816,39231643,39261612,39375868,39418471,39428988,39521788,39651132,39656526,39671978,39727301,39835097,39872625,40052504,40093419,40223823,40248450,40267599,40296758,40327872,40338571,40344462,40351252,40461927,40486921,40504298,40527045,40620856,40626607,40653387,40662423,40799968,40836642,40843828,40885292,40893291,40910495,40917881,40931594,40934522,40949492,40952115,40962320,41102801,41115965,41125021,41207666,41213768,41216461,41307211,41326047,41370565,41431502,41512044,41538150,41554903,41583434,41603268,41643784,41674280,41708167,41745730,41775848,41816675,41819281,41848592,41932596,41955894,42106547,42153890,42226694,42242250,42285191,42364111,42426564,42456447,42631071,42657424,42697030,42735251,42747523,42752637,42786113,42807625,42837366,42847179,42940180,43017077,43071220,43106806,43116541,43175686,43310576,43319128,43320990,43390811,43454844,43500064,43594460,43699459,43854854,43861160,43941589,44039834,44069241,44131734,44159800,44228629,44244377,44278750,44399192,44410688,44444943,44480706,44518984,44533740,44556670,44579415,44590432,44642916,44683799,44741690,44753717,44811306,44898851,45067135,45071858,45161779,45206793,45211240,45294027,45296041,45303015,45406877,45418739,45502370,45532382,45545240,45592321,45659911,45668156,45683986,45697677,45791960,45878249,45913577,45926215,45960108,46019798,46074733,46100506,46180937,46205936,46296784,46306244,46697750,46709123,46787547,46791876,47046751,47289842,47332936,47474180,47478625,47485726,47487251,47523371,47528853,47546670,47585054,47613782,47654440,47820395,47942121,48020982,48081584,48209130,48217177,48314645,48406780,48409134,48509348,48858655,48861172,49023507,49050385,49053593,49095766,49134093,49205631,49364328,49382489,49384948,49389260,49410297,49460170,49524441,49546989,49581167,49586353,49588867,49673398,49708488,49877862,49887536,50155443,50166653,50174301,50200876,50216967,50319837,50332635,50371128,50398305,50420652,50485417,50541421,50694363,50783128,50884353,50887348,50888313,50922270,51028599,51028830,51078334,51100188,51125279,51126717,51130639,51165369,51206224,51277518,51429279,51443528,51466799,51538294,51668335,51681331,51733182,51772387,51779710,51811447,51821884,51850251,51891757,51894393,51901430,51936392,51941718,52055846,52089229,52103272,52181651,52217122,52294036,52304290,52427751,52449773,52503069,52530643,52643811,52728772,52744031,52809759,52829697,52853305,52891705,52892354,52937988,52941080,53000637,53013475,53111038,53260045,53413057,53450230,53483888,53516744,53605517,53605672,53612889,53638851,53664766,53687380,53693209,53699342,53762593,53799715,53853398,53941520,54229833,54234031,54291140,54348724,54382219,54448090,54553636,54584027,54585850,54636319,54661734)

        val result: List<Profile> = profileParser.getProfile(vkIds)

        assertEquals(2101, result.size)
    }

    @Test
    fun getProfile5() {
        assumeTrue("Ключ авторизации не указан", System.getProperties().containsKey("accessToken"))

        profileParser = ProfileParser(System.getProperty("accessToken"))
        val vkIds = listOf(4451,11012,14487,20642,22408,25498,32324,35605,55894,72618,83868,83922,86662,90107,106660,108896,139337,142487,143695,165723,176786,179802,180800,183711,186136,194112,194961,201541,217229,218622,232645,248454,253980,256823,275295,278570,304966,341599,342801,351391,351558,355069,359877,367115,384423,393967,398488,398633,405202,417500,421695,453749,463477,474788,499423,520616,534256,539336,543500,550877,573312,583988,584060,586828,593904,604279,615224,630020,633929,670601,674543,687237,690245,718103,719666,753706,757844,760263,765761,773070,773340,808571,829006,844695,855827,857439,867790,870137,877256,883208,901277,922459,932013,939383,952082,960491,969030,973789,996116,999411,1004480,1005720,1009221,1013617,1030178,1066051,1076584,1080178,1117363,1118628,1118879,1139027,1143370,1144684,1182344,1190711,1204705,1207009,1210016,1211565,1217153,1219296,1221219,1232309,1253989,1261072,1261230,1277529,1297505,1311302,1323138,1338704,1344200,1345212,1352877,1360630,1365944,1374732,1386570,1394146,1406920,1419501,1425444,1466354,1471344,1482955,1490860,1497259,1497323,1504094,1528621,1530741,1551424,1555694,1569340,1585370,1591482,1593674,1609644,1614456,1645800,1656166,1659842,1683019,1689361,1690334,1700961,1732249,1735475,1753629,1755438,1787150,1787618,1792628,1797965,1802436,1819704,1824661,1834625,1844937,1850608,1860445,1870328,1870591,1873878,1874495,1896915,1898844,1948924,1967961,1992516,1993245,1993956,2019173,2030882,2044872,2069945,2088613,2120747,2120775,2122581,2127999,2135584,2142114,2147802,2153396,2168766,2196541,2226518,2248810,2248974,2260681,2265383,2269505,2281560,2287623,2288979,2295911,2304593,2312954,2320282,2321866,2325179,2330480,2335826,2345223,2345440,2380690,2405689,2411187,2417809,2423721,2424539,2434482,2439126,2441983,2463410,2463736,2478857,2479985,2503832,2522142,2527530,2534703,2535179,2555392,2555800,2556409,2568977,2577333,2580363,2587254,2617006,2620136,2637393,2664151,2675910,2679109,2679285,2681072,2684720,2689059,2697538,2700514,2739757,2782211,2804935,2811261,2813390,2816489,2827716,2856350,2875090,2875391,2882489,2912003,2920493,2920654,2940582,2961412,2979910,2987978,2988515,2991684,2995422,3023716,3027859,3028921,3034215,3045850,3049178,3054866,3073153,3084889,3099259,3107718,3121897,3129156,3153676,3163069,3170389,3189280,3196195,3198187,3216628,3217182,3222304,3227597,3228545,3231147,3266969,3273521,3278630,3295299,3296178,3296218,3317614,3318909,3326678,3334761,3357644,3361151,3367904,3369641,3374004,3385374,3389477,3399993,3400083,3411288,3442521,3468951,3469628,3483584,3494847,3497799,3498532,3510637,3527291,3532127,3564871,3589802,3598589,3606487,3609288,3616708,3623116,3647780,3665813,3668457,3678747,3690759,3715953,3727794,3728056,3734029,3757928,3773135,3784273,3796200,3797033,3807216,3818792,3820799,3824022,3830080,3834023,3842921,3844591,3891904,3896538,3897524,3900080,3904101,3933775,3960412,3972430,3976989,3978940,3988624,3993706,4014106,4015087,4021312,4054337,4056941,4073335,4079682,4087670,4101613,4105843,4106345,4110085,4112469,4117228,4125529,4130013,4130230,4135236,4139179,4147060,4148003,4157524,4169399,4176217,4176727,4189417,4216135,4249780,4251193,4275783,4275813,4294930,4339659,4360161,4365627,4376754,4383610,4384022,4410479,4413840,4416812,4425845,4431305,4456455,4470256,4484005,4486873,4488581,4507784,4517481,4531662,4549783,4552035,4596629,4598626,4606897,4621929,4637812,4640297,4640600,4642623,4646058,4654755,4658185,4660065,4661588,4672096,4685987,4716727,4747098,4750929,4751571,4766883,4782923,4807323,4810890,4820752,4838434,4847392,4863089,4864744,4871860,4878307,4925353,4951130,4952066,5051566,5063217,5072162,5073118,5082432,5088829,5088927,5090691,5092257,5104232,5106947,5139588,5147438,5148898,5149422,5170586,5222826,5235720,5288960,5319657,5327376,5342664,5347635,5362778,5370152,5383985,5384030,5395223,5399846,5401880,5402975,5410997,5416638,5426096,5427286,5464692,5484752,5486802,5502072,5520691,5520939,5528840,5532181,5545542,5559842,5561146,5563144,5583703,5595607,5603024,5635679,5637574,5647211,5663965,5671061,5722826,5762175,5802859,5806070,5811052,5825762,5828810,5839252,5840816,5849139,5850693,5890467,5916193,5959617,5962909,5974974,6014449,6014828,6019453,6028537,6029110,6037006,6037720,6068162,6090409,6093223,6095753,6108798,6109810,6126320,6129600,6150064,6181702,6215701,6221646,6233397,6254632,6262938,6281345,6298929,6308962,6310991,6325506,6330141,6338082,6368641,6370630,6372257,6374147,6388070,6394351,6407610,6414225,6438464,6497478,6504723,6519015,6545887,6552084,6553292,6651086,6660950,6692280,6710957,6728002,6760446,6766022,6766171,6821487,6839850,6877598,6902050,6911400,6919293,6922275,6937016,6944329,6949544,7003444,7022348,7028194,7055438,7065927,7086208,7120826,7136018,7138048,7140535,7156533,7172640,7178586,7211348,7244514,7250789,7257697,7271669,7289402,7339724,7349423,7354696,7400842,7404124,7417735,7423798,7429866,7436232,7446053,7451064,7467544,7472099,7472881,7474814,7478309,7481941,7509863,7569778,7590229,7620781,7639266,7648609,7650765,7655136,7667563,7678770,7695921,7710853,7733575,7735835,7765050,7788240,7816370,7824030,7826039,7826242,7830840,7850149,7873436,7901655,7921667,7932232,7949098,7957575,7981475,7982713,8029532,8091689,8099715,8117346,8136111,8158436,8183599,8189373,8190717,8195962,8200701,8200759,8212282,8229377,8236485,8250752,8259156,8283211,8293218,8306954,8315063,8329874,8335534,8390794,8391942,8394119,8419645,8428953,8437281,8441811,8441932,8443441,8459394,8461647,8473406,8486643,8501385,8505132,8552129,8573100,8577222,8615956,8626874,8631028,8698503,8703998,8707317,8722568,8730166,8735579,8738320,8746308,8748772,8752683,8762763,8779518,8806111,8809666,8816857,8832111,8833076,8837124,8881090,8904737,8914892,8920141,8921210,8934217,8952974,8953820,9009555,9029292,9040500,9061148,9064632,9117217,9144878,9171772,9176328,9204159,9211282,9213938,9289575,9306903,9313032,9323153,9338056,9369267,9375096,9380047,9410335,9439414,9458090,9481374,9553927,9560814,9582056,9599840,9601063,9606720,9673312,9674852,9730718,9732135,9738811,9759574,9761714,9773294,9780325,9782717,9787158,9804917,9832625,9842703,9871256,9872050,9893645,9908317,9914973,9918378,9927107,9931539,9957834,10007855,10007901,10017624,10018208,10027142,10069278,10086504,10103109,10157767,10194235,10213636,10223199,10238122,10248183,10254137,10278330,10286134,10289754,10312397,10322809,10332803,10334401,10363049,10390519,10396290,10403470,10468392,10480073,10504514,10507906,10575826,10596719,10603038,10615735,10663820,10693328,10698129,10702195,10744279,10806932,10811716,10874924,10882366,10887531,10918882,11034261,11065095,11078396,11095040,11120160,11141762,11166484,11167821,11196431,11208102,11210234,11217306,11228065,11230278,11234513,11264304,11272808,11298033,11302371,11302738,11309782,11315470,11338096,11345308,11352776,11380136,11408375,11425354,11428387,11428874,11452362,11488114,11495762,11506958,11512296,11524758,11529005,11530492,11530813,11546609,11547869,11572920,11617708,11618253,11619944,11632503,11633063,11641624,11670593,11706041,11714360,11719873,11728707,11804118,11823271,11833249,11850561,11879095,11895880,11939337,11945067,11959091,11998156,12023413,12078379,12092224,12159980,12167806,12186167,12188890,12218971,12231793,12278873,12331860,12332528,12357864,12414359,12415598,12431597,12441295,12449407,12492863,12528130,12555103,12576134,12590586,12599318,12613426,12629845,12660160,12725319,12743671,12772032,12788337,12813580,12820222,12880303,12910028,13002599,13013124,13037445,13050502,13062627,13063963,13111499,13136804,13141720,13259656,13353079,13358689,13363049,13383212,13432584,13440882,13441516,13451864,13496339,13527595,13541243,13555969,13662622,13678060,13678102,13683910,13698924,13730355,13749423,13751396,13771290,13791415,13791485,13792968,13815759,13839573,13957337,13958643,13976497,14032217,14074241,14085012,14107592,14125408,14128444,14130957,14169577,14170672,14182565,14191919,14202290,14203531,14206216,14206582,14224876,14234674,14246504,14261217,14271280,14279801,14287484,14289868,14318727,14336124,14368578,14389739,14419054,14434204,14449009,14460957,14462843,14500261,14525705,14563126,14566098,14583837,14584324,14586174,14614778,14642724,14716596,14763794,14774970,14799518,14848704,14849805,14862832,14935728,14939583,14954808,14957227,14961794,15010224,15045935,15084913,15127088,15133670,15137997,15143481,15145561,15153846,15200821,15205081,15302763,15303394,15338939,15379550,15413729,15433972,15441299,15451994,15466745,15529377,15535833,15574894,15592575,15603672,15627435,15645146,15646415,15647890,15651099,15676618,15698010,15700063,15700145,15729729,15764160,15808789,15857516,15858326,15898108,15904595,15905318,15918702,15929438,15951404,15954267,15969664,15997527,16017998,16031224,16036878,16042625,16082555,16088767,16113275,16150312,16159813,16160592,16174819,16262396,16294293,16315033,16316785,16322535,16322884,16355581,16428414,16432405,16455007,16478153,16478441,16544512,16546859,16554025,16558158,16633763,16654904,16662504,16689571,16742090,16744540,16812832,16816968,16848187,16852157,16877844,16880520,17051222,17113257,17128287,17142730,17151654,17176075,17199756,17229776,17234778,17272176,17274903,17283267,17294712,17300542,17342603,17357817,17373285,17375971,17402715,17418836,17423482,17434461,17482160,17483610,17501587,17508679,17542475,17651320,17699958,17704072,17710679,17746442,17758535,17762547,17765765,17766406,17776363,17824396,17825549,17826525,17836886,17879996,17890562,17919489,17948382,17950894,17970528,18010333,18027949,18037356,18044266,18080975,18093941,18114501,18127974,18130232,18139156,18145909,18150460,18153382,18171071,18182371,18274695,18305696,18312308,18325240,18326066,18329708,18354755,18385074,18405241,18414075,18430708,18454707,18470692,18553194,18659803,18671587,18678850,18679686,18699369,18712839,18713794,18748364,18768368,18773951,18774274,18780310,18781680,18834789,18876273,18883522,18904942,18909479,18940615,19004670,19010463,19024686,19036273,19075734,19078864,19104233,19156891,19166548,19188565,19217848,19223841,19237222,19266598,19277774,19281076,19296946,19300990,19305609,19309483,19317962,19330982,19332751,19339123,19360492,19371475,19402549,19403308,19432367,19433727,19444608,19466479,19518701,19611360,19692880,19697691,19755505,19774210,19792610,19809907,19815332,19821596,19822362,19905070,19909716,20034037,20066762,20069972,20091147,20098023,20112155,20116944,20164150,20166556,20168330,20173171,20207832,20215266,20221512,20236839,20259518,20274530,20306126,20332670,20375132,20399181,20433836,20445905,20446128,20454496,20468273,20471174,20484140,20506020,20506477,20528255,20528989,20565861,20568334,20586366,20592240,20592444,20617381,20617475,20626469,20654511,20659329,20663338,20691037,20708560,20784308,20786911,20810274,20849805,20854342,20861966,20867263,20903315,20904485,20915397,20940851,20945743,21003321,21024938,21043955,21069619,21082970,21129509,21182619,21217421,21231589,21235942,21253463,21264536,21312382,21315158,21392305,21393825,21394374,21454294,21460417,21471756,21548036,21594285,21599581,21642485,21716843,21764064,21783282,21816765,21830375,21855554,21864661,21929383,22005092,22063639,22085520,22128412,22148931,22244869,22250291,22280389,22402367,22421991,22436623,22446352,22461596,22485554,22510430,22541887,22543298,22571520,22579559,22628809,22653856,22658411,22660324,22679615,22681435,22690088,22698740,22704914,22718979,22733989,22734288,22763343,22766248,22808179,22813226,22821549,22844011,22852589,22886200,22889341,22897287,22951513,23027915,23032874,23040847,23070285,23145363,23159485,23167223,23193467,23205945,23221883,23238954,23292835,23307966,23309328,23328036,23392240,23402690,23404758,23437605,23440396,23466495,23484702,23504026,23539069,23583460,23697088,23702090,23709619,23739051,23781795,23787537,23852173,23883948,23888335,23922074,23931010,24016623,24017420,24059441,24071477,24072155,24081506,24087693,24149753,24168471,24174986,24175846,24199013,24221611,24243103,24254159,24255695,24321442,24366532,24370394,24379837,24495638,24496049,24572941,24582675,24593565,24628596,24661869,24673641,24675391,24701844,24724401,24734708,24796891,24850333,24929449,24966125,25072101,25120029,25146411,25260511,25264142,25267582,25270141,25318578,25342235,25350777,25373281,25387860,25404974,25415614,25445668,25452098,25466484,25472838,25521028,25576528,25601265,25605243,25606571,25646299,25652329,25654084,25693757,25698649,25701012,25782685,25837808,25860914,25873542,25884931,25967311,26082478,26098474,26117564,26143548,26154539,26166821,26190480,26240236,26243477,26266380,26270845,26285273,26366105,26427838,26445118,26456296,26461024,26487858,26524848,26544543,26565846,26700000,26761425,26871440,26872374,26873913,26880363,26906492,26909170,26961770,27002768,27013345,27043662,27190495,27207848,27258317,27259721,27264985,27274799,27277214,27323177,27334439,27370935,27372723,27377140,27378077,27417769,27480155,27508513,27511741,27517165,27540087,27574482,27584127,27589485,27638570,27693774,27707088,27722846,27733929,27853292,28067432,28103082,28140555,28176358,28194555,28209318,28231752,28312283,28326920,28333924,28486833,28533793,28632151,28657267,28697970,28710403,28739872,28852771,28877841,28887597,28929034,28933450,29028876,29038148,29053567,29054843,29061991,29104697,29125589,29197071,29234639,29256646,29316162,29317748,29348738,29354899,29362554,29366784,29524874,29543514,29574735,29662356,29801279,29821213,29823023,29903130,29950520,30006001,30024409,30076693,30096540,30117267,30119508,30186700,30202041,30274772,30310600,30375825,30414758,30416431,30428273,30451966,30483060,30493143,30520286,30606451,30706131,30720363,30725550,30728630,30906606,31016405,31059808,31061544,31145080,31243318,31251440,31259212,31363841,31367821,31372098,31517418,31544322,31552873,31570206,31661094,31664402,31672030,31674516,31687874,31707826,31768124,31823581,31826429,31846310,31908510,31914357,31935312,31963430,32044407,32095788,32125669,32130752,32149219,32157954,32166386,32181080,32245464,32247941,32249651,32281139,32322216,32456651,32538219,32576445,32594811,32614222,32636483,32663693,32765351,32800278,32860707,32878913,32910174,32920651,32940658,32997135,33007532,33008548,33067877,33137636,33197015,33221917,33329565,33365891,33383165,33391542,33453272,33460717,33470374,33475735,33501981,33516585,33516657,33572912,33573077,33575244,33595809,33727751,33773067,33833197,33938156,33965171,33969805,34034922,34066268,34069745,34133731,34156095,34210939,34356988,34411413,34415242,34441211,34486166,34578696,34627624,34636155,34674913,34834698,34849779,34940419,34942884,35022550,35144578,35145883,35248446,35309037,35371655,35604801,35698292,35703642,35776203,35908161,35916097,35945890,36061760,36066036,36205545,36284530,36329569,36344509,36391973,36438364,36444747,36461813,36533358,36656759,36744024,36806935,36840660,36841665,36871613,36932515,37011987,37080266,37096025,37135847,37225669,37269095,37302374,37385059,37398159,37453073,37482960,37643916,37663945,37695610,37766696,37842607,37887205,38010722,38149031,38204270,38210250,38218997,38240114,38256015,38326500,38379137,38381512,38491647,38548314,38600319,38609445,38612300,38660742,38717867,38810653,38823249,38832227,38849197,38896662,38959835,39016282,39054401,39075718,39098188,39121923,39198816,39231643,39261612,39375868,39418471,39428988,39521788,39651132,39656526,39671978,39727301,39835097,39872625,40052504,40093419,40223823,40248450,40267599,40296758,40327872,40338571,40344462,40351252,40461927,40486921,40504298,40527045,40620856,40626607,40653387,40662423,40799968,40836642,40843828,40885292,40893291,40910495,40917881,40931594,40934522,40949492,40952115,40962320,41102801,41115965,41125021,41207666,41213768,41216461,41307211,41326047,41370565,41431502,41512044,41538150,41554903,41583434,41603268,41643784,41674280,41708167,41745730,41775848,41816675,41819281,41848592,41932596,41955894,42106547,42153890,42226694,42242250,42285191,42364111,42426564,42456447,42631071,42657424,42697030,42735251,42747523,42752637,42786113,42807625,42837366,42847179,42940180,43017077,43071220,43106806,43116541,43175686,43310576,43319128,43320990,43390811,43454844,43500064,43594460,43699459,43854854,43861160,43941589,44039834,44069241,44131734,44159800,44228629,44244377,44278750,44399192,44410688,44444943,44480706,44518984,44533740,44556670,44579415,44590432,44642916,44683799,44741690,44753717,44811306,44898851,45067135,45071858,45161779,45206793,45211240,45294027,45296041,45303015,45406877,45418739,45502370,45532382,45545240,45592321,45659911,45668156,45683986,45697677,45791960,45878249,45913577,45926215,45960108,46019798,46074733,46100506,46180937,46205936,46296784,46306244,46697750,46709123,46787547,46791876,47046751,47289842,47332936,47474180,47478625,47485726,47487251,47523371,47528853,47546670,47585054,47613782,47654440,47820395,47942121,48020982,48081584,48209130,48217177,48314645,48406780,48409134,48509348,48858655,48861172,49023507,49050385,49053593,49095766,49134093,49205631,49364328,49382489,49384948,49389260,49410297,49460170,49524441,49546989,49581167,49586353,49588867,49673398,49708488,49877862,49887536,50155443,50166653,50174301,50200876,50216967,50319837,50332635,50371128,50398305,50420652,50485417,50541421,50694363,50783128,50884353,50887348,50888313,50922270,51028599,51028830,51078334,51100188,51125279,51126717,51130639,51165369,51206224,51277518,51429279,51443528,51466799,51538294,51668335,51681331,51733182,51772387,51779710,51811447,51821884,51850251,51891757,51894393,51901430,51936392,51941718,52055846,52089229,52103272,52181651,52217122,52294036,52304290,52427751,52449773,52503069,52530643,52643811,52728772,52744031,52809759,52829697,52853305,52891705,52892354,52937988,52941080,53000637,53013475,53111038,53260045,53413057,53450230,53483888,53516744,53605517,53605672,53612889,53638851,53664766,53687380,53693209,53699342,53762593,53799715,53853398,53941520,54229833,54234031,54291140,54348724,54382219,54448090,54553636,54584027,54585850,54636319,54661734)

        val result: List<Profile> = profileParser.getProfile(vkIds)
        assertEquals(2101, result.size)
    }
}